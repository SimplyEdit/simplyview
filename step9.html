<h1>one way and two way databinding to multiple fields with simple api</h1>
<h2>Cleanup</h2>

<script src="js/simply.path.js"></script>
<script src="js/simply.bind.js"></script>
<script src="js/simply.commands.js"></script>
<script src="js/simply.js"></script>

<h1 contenteditable=true data-bind="title">title</h1>
<p contenteditable=true data-bind="description">description</p>
<div><label>Name:</label><span contenteditable="true" data-bind="user.name"></span></div>
<div><label>Email:</label><span contenteditable="true" data-bind="user.email"></span></div>
<pre contenteditable=true data-bind="title"></pre>
<a href="bla" title="foo" data-bind="link" contenteditable=true>Link</a>
<input type="text" name="foo" data-bind="input" value="bar">

<div id="counter">
	<input type="text" data-bind="counter">
	<button data-simply-command="add1">+</button>
	<button data-simply-command="sub1">-</button>
</div>

<script>

	window.model = {
		title: "A nice title",
		user: {
		  name: "Mr. User",
		  email: "user@example.org"
		},
		link: {
			href: 'https://www.muze.nl/',
			title: 'Muze',
			innerHTML: 'Link naar Muze'
		},
		input: 'waarde',
		counter: 1
	};

	var app = simply.app({
		container: document.getElementById('counter'),
		commands: {
			add1: function() {
				model.counter++;
			},
			sub1: function() {
				model.counter--;
			}
		}
	});

  
  var bindings = simply.bind({
  	model: window.model,
	fieldTypes: {
		'a': {
			init: function() {
			},
			set: function(value) {
				this.href = value && value.href ? value.href : '';
				this.title = value && value.title ? value.title : '';
				this.innerHTML = value && value.innerHTML ? value.innerHTML : '';
			},
			get: function() {
				return {
					href: this.href,
					title: this.title,
					innerHTML: this.innerHTML
				}
			}
		},
		'input[type=text]': {
			init: function() {
				this.addEventListener('input', function(evt) {
					this.dispatchEvent(new Event('simply.bind.update', {
						bubbles: true,
						cancelable: true
					}));
				});
			},
			set: function(value) {
				this.value = value;
			},
			get: function() {
				return this.value;
			}
		}
	}
  }).observe(document.body);
</script>
<h2>Try:</h2>
<pre>
    model.link.href = "foo";
    model.link = null;
    model.link = { href: '//muze.nl/', title: 'Muze', innerHTML: 'Muze' };
    model.title = 'foo &lt;span data-bind="user.name"&gt;&lt;/span&gt; bar'
    bindings.addListener('user.name', function(value) {
    	console.log('user.name changed to '+value);
	});
	document.addEventListener('simply.bind.resolved', function(evt) {
		console.log('resolved: '+evt.target.outerHTML);
	});
</pre>
<pre>
var bindings = simply.bind({
	model: model,
	selector: '[data-bind]',
	fieldTypes: {
		'a': {
			set: function(value) {
				this.href = value.href;
				this.title = value.title;
				this.innerHTML = value.innerHTML;
			},
			get: function() {
				return {
					href: this.href,
					title: this.title,
					innerHTML: this.innerHTML
				}
			}
		},
		'input[type=text]': {
			init: function() {
				this.addEventListener('input', function(evt) {
					this.dispatchEvent(new Event('simply.bind.update', {
						bubbles: true,
						cancelable: true
					}));
				});
			},
			set: function(value) {
				this.value = value;
			},
			get: function() {
				return this.value;
			}
		},
		'[data-content="template"]': {
			init: function() {
				// find and remove templates
			},
			set: function(value) {
				this.dataset.value = value;
				// replace contents with matching template
			},
			get: function() {
				return this.dataset.value;
			},
			allowNesting: true
		}
	}
});
.observe(document.body);

</pre>